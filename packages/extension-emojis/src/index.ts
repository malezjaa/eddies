import { textInputRule, markPasteRule, Mark } from "@tiptap/core";

interface EmojiReplacement {
  find: RegExp;
  replace: string;
}

const emojiReplacements: EmojiReplacement[] = [
  { find: /:\* $/, replace: "ğŸ˜˜ " },
  { find: /=\* $/, replace: "ğŸ˜˜ " },
  { find: /:\) $/, replace: "ğŸ™‚ " },
  { find: /=\] $/, replace: "ğŸ™‚ " },
  { find: /=\) $/, replace: "ğŸ™‚ " },
  { find: /:\] $/, replace: "ğŸ™‚ " },
  { find: /:X $/, replace: "ğŸ˜¶ " },
  { find: /:# $/, replace: "ğŸ˜¶ " },
  { find: /=X $/, replace: "ğŸ˜¶ " },
  { find: /=x $/, replace: "ğŸ˜¶ " },
  { find: /:x $/, replace: "ğŸ˜¶ " },
  { find: /=# $/, replace: "ğŸ˜¶ " },
  { find: /:O $/, replace: "ğŸ˜® " },
  { find: /:o $/, replace: "ğŸ˜® " },
  { find: /:P $/, replace: "ğŸ˜› " },
  { find: /=P $/, replace: "ğŸ˜› " },
  { find: /:p $/, replace: "ğŸ˜›  " },
  { find: /=p $/, replace: "ğŸ˜› " },
  { find: /:Ã $/, replace: "ğŸ˜› " },
  { find: /:Ã¾ $/, replace: "ğŸ˜› " },
  { find: /:b $/, replace: "ğŸ˜› " },
  { find: /d: $/, replace: "ğŸ˜› " },
  { find: /-___- $/, replace: "ğŸ˜‘ " },
  { find: /:'-\) $/, replace: "ğŸ˜‚ " },
  { find: /':-\) $/, replace: "ğŸ˜… " },
  { find: /':-D $/, replace: "ğŸ˜… " },
  { find: />:-\) $/, replace: "ğŸ˜† " },
  { find: /-__- $/, replace: "ğŸ˜‘ " },
  { find: /':-\( $/, replace: "ğŸ˜“ " },
  { find: /:'-\( $/, replace: "ğŸ˜¢ " },
  { find: />:-\( $/, replace: "ğŸ˜  " },
  { find: /O:-\) $/, replace: "ğŸ˜‡ " },
  { find: /0:-3 $/, replace: "ğŸ˜‡ " },
  { find: /0:-\) $/, replace: "ğŸ˜‡ " },
  { find: /0;\^\) $/, replace: "ğŸ˜‡ " },
  { find: /O;-\) $/, replace: "ğŸ˜‡ " },
  { find: /0;-\) $/, replace: "ğŸ˜‡ " },
  { find: /O:-3 $/, replace: "ğŸ˜‡ " },
  { find: /:'\) $/, replace: "ğŸ˜‚ " },
  { find: /:-D $/, replace: "ğŸ˜ƒ " },
  { find: /':\) $/, replace: "ğŸ˜… " },
  { find: /'=\) $/, replace: "ğŸ˜… " },
  { find: /':D $/, replace: "ğŸ˜… " },
  { find: /'=D $/, replace: "ğŸ˜… " },
  { find: />:\) $/, replace: "ğŸ˜† " },
  { find: />;\) $/, replace: "ğŸ˜† " },
  { find: />=\) $/, replace: "ğŸ˜† " },
  { find: /;-\) $/, replace: "ğŸ˜‰ " },
  { find: /\*-\) $/, replace: "ğŸ˜‰ " },
  { find: /;-\] $/, replace: "ğŸ˜‰ " },
  { find: /;\^\) $/, replace: "ğŸ˜‰ " },
  { find: /B-\) $/, replace: "ğŸ˜ " },
  { find: /8-\) $/, replace: "ğŸ˜ " },
  { find: /B-D $/, replace: "ğŸ˜ " },
  { find: /8-D $/, replace: "ğŸ˜ " },
  { find: /:-\* $/, replace: "ğŸ˜˜ " },
  { find: /:\^\* $/, replace: "ğŸ˜˜ " },
  { find: /:-\) $/, replace: "ğŸ™‚ " },
  { find: /-_- $/, replace: "ğŸ˜‘ " },
  { find: /:-X $/, replace: "ğŸ˜¶ " },
  { find: /:-# $/, replace: "ğŸ˜¶ " },
  { find: /:-x $/, replace: "ğŸ˜¶ " },
  { find: />.< $/, replace: "ğŸ˜£ " },
  { find: /:-O $/, replace: "ğŸ˜® " },
  { find: /:-o $/, replace: "ğŸ˜® " },
  { find: /O_O $/, replace: "ğŸ˜® " },
  { find: />:O $/, replace: "ğŸ˜® " },
  { find: /:-P $/, replace: "ğŸ˜› " },
  { find: /:-p $/, replace: "ğŸ˜› " },
  { find: /:-Ã $/, replace: "ğŸ˜› " },
  { find: /:-Ã¾ $/, replace: "ğŸ˜› " },
  { find: /:-b $/, replace: "ğŸ˜› " },
  { find: />:P $/, replace: "ğŸ˜œ " },
  { find: /X-P $/, replace: "ğŸ˜œ " },
  { find: /x-p $/, replace: "ğŸ˜œ " },
  { find: /':\( $/, replace: "ğŸ˜“ " },
  { find: /'=\( $/, replace: "ğŸ˜“ " },
  { find: />:\\ $/, replace: "ğŸ˜• " },
  { find: />:\/ $/, replace: "ğŸ˜• " },
  { find: /:-\/ $/, replace: "ğŸ˜• " },
  { find: /:-. $/, replace: "ğŸ˜• " },
  { find: />:\[ $/, replace: "ğŸ˜ " },
  { find: /:-\( $/, replace: "ğŸ˜ " },
  { find: /:-\[ $/, replace: "ğŸ˜ " },
  { find: /:'\( $/, replace: "ğŸ˜¢ " },
  { find: /;-\( $/, replace: "ğŸ˜¢ " },
  { find: /#-\) $/, replace: "ğŸ˜µ " },
  { find: /%-\) $/, replace: "ğŸ˜µ " },
  { find: /X-\) $/, replace: "ğŸ˜µ " },
  { find: />:\( $/, replace: "ğŸ˜  " },
  { find: /0:3 $/, replace: "ğŸ˜‡ " },
  { find: /0:\) $/, replace: "ğŸ˜‡ " },
  { find: /O:\) $/, replace: "ğŸ˜‡ " },
  { find: /O=\) $/, replace: "ğŸ˜‡ " },
  { find: /O:3 $/, replace: "ğŸ˜‡ " },
  { find: /<\/3 $/, replace: "ğŸ’” " },
  { find: /:D $/, replace: "ğŸ˜ƒ " },
  { find: /=D $/, replace: "ğŸ˜ƒ " },
  { find: /;\) $/, replace: "ğŸ˜‰ " },
  { find: /\*\) $/, replace: "ğŸ˜‰ " },
  { find: /;\] $/, replace: "ğŸ˜‰ " },
  { find: /;D $/, replace: "ğŸ˜‰ " },
  { find: /B\) $/, replace: "ğŸ˜ " },
  { find: /8\) $/, replace: "ğŸ˜ " },
  { find: /:\/ $/, replace: "ğŸ˜• " },
  { find: /:\\ $/, replace: "ğŸ˜• " },
  { find: /=\/ $/, replace: "ğŸ˜• " },
  { find: /=\\ $/, replace: "ğŸ˜• " },
  { find: /:L $/, replace: "ğŸ˜• " },
  { find: /=L $/, replace: "ğŸ˜• " },
  { find: /:\( $/, replace: "ğŸ˜ " },
  { find: /:\[ $/, replace: "ğŸ˜ " },
  { find: /=\( $/, replace: "ğŸ˜ " },
  { find: /;\( $/, replace: "ğŸ˜¢ " },
  { find: /D: $/, replace: "ğŸ˜¨ " },
  { find: /:\$ $/, replace: "ğŸ˜³ " },
  { find: /=\$ $/, replace: "ğŸ˜³ " },
  { find: /#-\) $/, replace: "ğŸ˜µ " },
  { find: /%-\) $/, replace: "ğŸ˜µ " },
  { find: /X-\) $/, replace: "ğŸ˜µ " },
  { find: /:@ $/, replace: "ğŸ˜  " },
  { find: /<3 $/, replace: "â¤ï¸ " },

  { find: /:heart: $/, replace: "â¤ï¸ " },
  { find: /:heartpulse: $/, replace: "ğŸ’— " },
  { find: /:heartbeat: $/, replace: "ğŸ’“ " },
  { find: /:heart_decoration: $/, replace: "ğŸ’Ÿ " },
  { find: /:two_hearts: $/, replace: "ğŸ’• " },
  { find: /:revolving_hearts: $/, replace: "ğŸ’ " },
  { find: /:cupid: $/, replace: "ğŸ’˜ " },
  { find: /:sparkling_heart: $/, replace: "ğŸ’– " },
  { find: /:sparkles: $/, replace: "âœ¨ " },
  { find: /:star2: $/, replace: "ğŸŒŸ " },
  { find: /:dizzy: $/, replace: "ğŸ’« " },
  { find: /:boom: $/, replace: "ğŸ’¥ " },
  { find: /:collision: $/, replace: "ğŸ’¥ " },
  { find: /:anger: $/, replace: "ğŸ’¢ " },
  { find: /:exclamation: $/, replace: "â— " },
  { find: /:question: $/, replace: "â“ " },
  { find: /:grey_exclamation: $/, replace: "â• " },
  { find: /:grey_question: $/, replace: "â” " },
  { find: /:zzz: $/, replace: "ğŸ’¤ " },
  { find: /:dash: $/, replace: "ğŸ’¨ " },
  { find: /:sweat_drops: $/, replace: "ğŸ’¦ " },
  { find: /:notes: $/, replace: "ğŸ¶ " },
  { find: /:musical_note: $/, replace: "ğŸµ " },
  { find: /:fire: $/, replace: "ğŸ”¥ " },
  { find: /:poop: $/, replace: "ğŸ’© " },
  { find: /:grinning: $/, replace: "ğŸ˜€ " },
  { find: /:smiley: $/, replace: "ğŸ˜ƒ " },
  { find: /:smile: $/, replace: "ğŸ˜„ " },
  { find: /:grin: $/, replace: "ğŸ˜ " },
  { find: /:laughing: $/, replace: "ğŸ˜† " },
  { find: /:satisfied: $/, replace: "ğŸ˜† " },
  { find: /:sweat_smile: $/, replace: "ğŸ˜… " },
  { find: /:rofl: $/, replace: "ğŸ¤£ " },
  { find: /:joy: $/, replace: "ğŸ˜‚ " },
  { find: /:slightly_smiling_face: $/, replace: "ğŸ™‚ " },
  { find: /:upside_down_face: $/, replace: "ğŸ™ƒ " },
  { find: /:wink: $/, replace: "ğŸ˜‰ " },
  { find: /:blush: $/, replace: "ğŸ˜Š " },
  { find: /:innocent: $/, replace: "ğŸ˜‡ " },
  { find: /:smiling_face_with_three_hearts: $/, replace: "ğŸ¥° " },
  { find: /:heart_eyes: $/, replace: "ğŸ˜ " },
  { find: /:star_struck: $/, replace: "ğŸ¤© " },
  { find: /:kissing_heart: $/, replace: "ğŸ˜˜ " },
  { find: /:kissing: $/, replace: "ğŸ˜— " },
  { find: /:relaxed: $/, replace: "â˜ºï¸ " },
  { find: /:kissing_closed_eyes: $/, replace: "ğŸ˜š " },
  { find: /:kissing_smiling_eyes: $/, replace: "ğŸ˜™ " },
  { find: /:yum: $/, replace: "ğŸ˜‹ " },
  { find: /:stuck_out_tongue: $/, replace: "ğŸ˜› " },
  { find: /:stuck_out_tongue_winking_eye: $/, replace: "ğŸ˜œ " },
  { find: /:zany_face: $/, replace: "ğŸ¤ª " },
  { find: /:stuck_out_tongue_closed_eyes: $/, replace: "ğŸ˜ " },
  { find: /:money_mouth_face: $/, replace: "ğŸ¤‘ " },
  { find: /:hugs: $/, replace: "ğŸ¤— " },
  { find: /:hand_over_mouth: $/, replace: "ğŸ¤­ " },
  { find: /:shushing_face: $/, replace: "ğŸ¤« " },
  { find: /:thinking: $/, replace: "ğŸ¤” " },
  { find: /:zipper_mouth_face: $/, replace: "ğŸ¤ " },
  { find: /:raised_eyebrow: $/, replace: "ğŸ¤¨ " },
  { find: /:neutral_face: $/, replace: "ğŸ˜ " },
  { find: /:expressionless: $/, replace: "ğŸ˜‘ " },
  { find: /:no_mouth: $/, replace: "ğŸ˜¶ " },
  { find: /:smirk: $/, replace: "ğŸ˜ " },
  { find: /:unamused: $/, replace: "ğŸ˜’ " },
  { find: /:roll_eyes: $/, replace: "ğŸ™„ " },
  { find: /:grimacing: $/, replace: "ğŸ˜¬ " },
  { find: /:lying_face: $/, replace: "ğŸ¤¥ " },
  { find: /:relieved: $/, replace: "ğŸ˜Œ " },
  { find: /:pensive: $/, replace: "ğŸ˜” " },
  { find: /:sleepy: $/, replace: "ğŸ˜ª " },
  { find: /:drooling_face: $/, replace: "ğŸ¤¤ " },
  { find: /:sleeping: $/, replace: "ğŸ˜´ " },
  { find: /:mask: $/, replace: "ğŸ˜· " },
  { find: /:face_with_thermometer: $/, replace: "ğŸ¤’ " },
  { find: /:face_with_head_bandage: $/, replace: "ğŸ¤• " },
  { find: /:nauseated_face: $/, replace: "ğŸ¤¢ " },
  { find: /:vomiting_face: $/, replace: "ğŸ¤® " },
  { find: /:sneezing_face: $/, replace: "ğŸ¤§ " },
  { find: /:hot_face: $/, replace: "ğŸ¥µ " },
  { find: /:cold_face: $/, replace: "ğŸ¥¶ " },
  { find: /:woozy_face: $/, replace: "ğŸ¥´ " },
  { find: /:dizzy_face: $/, replace: "ğŸ˜µ " },
  { find: /:exploding_head: $/, replace: "ğŸ¤¯ " },
  { find: /:cowboy_hat_face: $/, replace: "ğŸ¤  " },
  { find: /:partying_face: $/, replace: "ğŸ¥³ " },
  { find: /:sunglasses: $/, replace: "ğŸ˜ " },
  { find: /:nerd_face: $/, replace: "ğŸ¤“ " },
  { find: /:monocle_face: $/, replace: "ğŸ§ " },
  { find: /:confused: $/, replace: "ğŸ˜• " },
  { find: /:worried: $/, replace: "ğŸ˜Ÿ " },
  { find: /:slightly_frowning_face: $/, replace: "ğŸ™ " },
  { find: /:frowning_face: $/, replace: "â˜¹ï¸ " },
  { find: /:open_mouth: $/, replace: "ğŸ˜® " },
  { find: /:hushed: $/, replace: "ğŸ˜¯ " },
  { find: /:astonished: $/, replace: "ğŸ˜² " },
  { find: /:flushed: $/, replace: "ğŸ˜³ " },
  { find: /:pleading_face: $/, replace: "ğŸ¥º " },
  { find: /:frowning: $/, replace: "ğŸ˜¦ " },
  { find: /:anguished: $/, replace: "ğŸ˜§ " },
  { find: /:fearful: $/, replace: "ğŸ˜¨ " },
  { find: /:cold_sweat: $/, replace: "ğŸ˜° " },
  { find: /:disappointed_relieved: $/, replace: "ğŸ˜¥ " },
  { find: /:cry: $/, replace: "ğŸ˜¢ " },
  { find: /:sob: $/, replace: "ğŸ˜­ " },
  { find: /:scream: $/, replace: "ğŸ˜± " },
  { find: /:confounded: $/, replace: "ğŸ˜– " },
  { find: /:persevere: $/, replace: "ğŸ˜£ " },
  { find: /:disappointed: $/, replace: "ğŸ˜ " },
  { find: /:sweat: $/, replace: "ğŸ˜“ " },
  { find: /:weary: $/, replace: "ğŸ˜© " },
  { find: /:tired_face: $/, replace: "ğŸ˜« " },
  { find: /:yawning_face: $/, replace: "ğŸ¥± " },
  { find: /:triumph: $/, replace: "ğŸ˜¤ " },
  { find: /:rage: $/, replace: "ğŸ˜¡ " },
  { find: /:angry: $/, replace: "ğŸ˜  " },
  { find: /:cursing_face: $/, replace: "ğŸ¤¬ " },
  { find: /:smiling_imp: $/, replace: "ğŸ˜ˆ " },
  { find: /:imp: $/, replace: "ğŸ‘¿ " },
  { find: /:skull: $/, replace: "ğŸ’€ " },
  { find: /:skull_and_crossbones: $/, replace: "â˜ ï¸ " },
  { find: /:hankey: $/, replace: "ğŸ’© " },
  { find: /:clown_face: $/, replace: "ğŸ¤¡ " },
  { find: /:japanese_ogre: $/, replace: "ğŸ‘¹ " },
  { find: /:japanese_goblin: $/, replace: "ğŸ‘º " },
  { find: /:ghost: $/, replace: "ğŸ‘» " },
  { find: /:alien: $/, replace: "ğŸ‘½ " },
  { find: /:space_invader: $/, replace: "ğŸ‘¾ " },
  { find: /:robot: $/, replace: "ğŸ¤– " },
  { find: /:smiley_cat: $/, replace: "ğŸ˜º " },
  { find: /:smile_cat: $/, replace: "ğŸ˜¸ " },
  { find: /:joy_cat: $/, replace: "ğŸ˜¹ " },
  { find: /:heart_eyes_cat: $/, replace: "ğŸ˜» " },
  { find: /:smirk_cat: $/, replace: "ğŸ˜¼ " },
  { find: /:kissing_cat: $/, replace: "ğŸ˜½ " },
  { find: /:scream_cat: $/, replace: "ğŸ™€ " },
  { find: /:crying_cat_face: $/, replace: "ğŸ˜¿ " },
  { find: /:pouting_cat: $/, replace: "ğŸ˜¾ " },
  { find: /:palms_up_together: $/, replace: "ğŸ¤² " },
  { find: /:raised_hands: $/, replace: "ğŸ™Œ " },
  { find: /:clap: $/, replace: "ğŸ‘ " },
  { find: /:wave: $/, replace: "ğŸ‘‹ " },
  { find: /:call_me_hand: $/, replace: "ğŸ¤™ " },
  { find: /:thumbsup: $/, replace: "ğŸ‘ " },
  { find: /:thumbsdown: $/, replace: "ğŸ‘ " },
  { find: /:punch: $/, replace: "ğŸ‘Š " },
  { find: /:fist: $/, replace: "âœŠ " },
  { find: /:left_facing_fist: $/, replace: "ğŸ¤› " },
  { find: /:right_facing_fist: $/, replace: "ğŸ¤œ " },
  { find: /:raised_back_of_hand: $/, replace: "ğŸ¤š " },
  { find: /:hand_splayed: $/, replace: "ğŸ– " },
  { find: /:vulcan_salute: $/, replace: "ğŸ–– " },
  { find: /:ok_hand: $/, replace: "ğŸ‘Œ " },
  { find: /:pinched_fingers: $/, replace: "ğŸ¤Œ " },
  { find: /:pinching_hand: $/, replace: "ğŸ¤ " },
  { find: /:v: $/, replace: "âœŒï¸ " },
  { find: /:crossed_fingers: $/, replace: "ğŸ¤ " },
  { find: /:love_you_gesture: $/, replace: "ğŸ¤Ÿ " },
  { find: /:metal: $/, replace: "ğŸ¤˜ " },
  { find: /:call_me: $/, replace: "ğŸ¤™ " },
  { find: /:point_left: $/, replace: "ğŸ‘ˆ " },
  { find: /:point_right: $/, replace: "ğŸ‘‰ " },
  { find: /:point_up_2: $/, replace: "ğŸ‘† " },
  { find: /:middle_finger: $/, replace: "ğŸ–• " },
  { find: /:point_down: $/, replace: "ğŸ‘‡ " },
  { find: /:point_up: $/, replace: "â˜ï¸ " },
  { find: /:thumbsup: $/, replace: "ğŸ‘ " },
  { find: /:thumbsdown: $/, replace: "ğŸ‘ " },
  { find: /:fingers_crossed: $/, replace: "ğŸ¤ " },
  { find: /:vulcan_salute: $/, replace: "ğŸ–– " },
  { find: /:clap: $/, replace: "ğŸ‘ " },
  { find: /:raised_hands: $/, replace: "ğŸ™Œ " },
  { find: /:open_hands: $/, replace: "ğŸ‘ " },
  { find: /:palms_up_together: $/, replace: "ğŸ¤² " },
  { find: /:handshake: $/, replace: "ğŸ¤ " },
  { find: /:pray: $/, replace: "ğŸ™ " },
  { find: /:writing_hand: $/, replace: "âœï¸ " },
  { find: /:nail_care: $/, replace: "ğŸ’… " },
  { find: /:selfie: $/, replace: "ğŸ¤³ " },
  { find: /:muscle: $/, replace: "ğŸ’ª " },
  { find: /:mechanical_arm: $/, replace: "ğŸ¦¾ " },
  { find: /:mechanical_leg: $/, replace: "ğŸ¦¿ " },
  { find: /:leg: $/, replace: "ğŸ¦µ " },
  { find: /:foot: $/, replace: "ğŸ¦¶ " },
  { find: /:ear: $/, replace: "ğŸ‘‚ " },
  { find: /:ear_with_hearing_aid: $/, replace: "ğŸ¦» " },
  { find: /:nose: $/, replace: "ğŸ‘ƒ " },
  { find: /:brain: $/, replace: "ğŸ§  " },
  { find: /:tooth: $/, replace: "ğŸ¦· " },
  { find: /:skull: $/, replace: "ğŸ’€ " },
];

export type EmojisOptions = {
  emojiReplacements?: EmojiReplacement[];

  /**
   * How to handle the emoji replacements.
   * @default "merge"
   */
  mode: "merge" | "override";
};

export const Emojis = Mark.create<EmojisOptions>({
  name: "EddiesEmojis",

  addOptions() {
    return {
      emojiReplacements: emojiReplacements,
      mode: "merge",
    };
  },

  addInputRules() {
    const replacements =
      this.options?.mode === "merge"
        ? [...emojiReplacements, ...this.options?.emojiReplacements!]
        : this.options?.emojiReplacements!;

    return replacements!.map((emojiReplacement) => {
      return textInputRule({
        find: emojiReplacement.find,
        replace: emojiReplacement.replace,
      });
    });
  },

  addPasteRules() {
    const replacements =
      this.options?.mode === "merge"
        ? [...emojiReplacements, ...this.options?.emojiReplacements!]
        : this.options?.emojiReplacements!;

    return replacements!.map((emojiReplacement) => {
      return markPasteRule({
        find: toPasteRule(emojiReplacement.find),
        type: this.type,
      });
    });
  },
});

const toPasteRule = (regex: RegExp) => {
  if (regex.toString().slice(-2) === "/$") {
    let rgx = regex.source.replace("$/", "/g");
    return new RegExp(rgx);
  }
  return regex;
};
